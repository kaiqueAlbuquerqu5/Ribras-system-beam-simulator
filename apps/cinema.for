	IMPLICIT REAL*8(A-Z)
	INTEGER*4 LAB,PANG
	OPEN(1,FILE='CINEMA.DAT',STATUS='UNKNOWN')
	WRITE(*,1)
 1	FORMAT(1H ,'PROGRAMA PARA O CALCULO DE CINEMATICA')
	WRITE(*,2)
 2	FORMAT(1H ,'ENTRE COM A MASSA DO PROJETIL:')
	READ(*,*)M1
	WRITE(*,4)
 4	FORMAT(1H ,'ENTRE COM A MASSA DO ALVO:')
	READ(*,*)M2
	WRITE(*,6)
 6	FORMAT(1H ,'ENTRE COM A MASSA DA TERCEIRA PARTICULA:')
	READ(*,*)M3
	WRITE(*,8)
 8	FORMAT(1H ,'ENTRE COM A MASSA DA QUARTA PARTICULA:')
	READ(*,*)M4
	WRITE(*,10)
 10	FORMAT(1H ,'ENTRE COM A ENERGIA DO PROJETIL EM MEV:')
	READ(*,*)EI
	WRITE(*,12)
 12	FORMAT(1H ,'ENTRE COM O Q DA REACAO:')
	READ(*,*)Q
	WRITE(*,14)
 14	FORMAT(1H ,'ENTRE COM O ANGULO DE LAB. INICIAL:')
	READ(*,*)AI
	WRITE(*,16)
 16	FORMAT(1H ,'ENTRE COM O ANGULO DE LAB. FINAL:')
	READ(*,*)AF
	WRITE(*,18)
 18	FORMAT(1H ,'ENTRE COM O DELTA 0:')
	READ(*,*)DELTA
C	CALCULO DA ENERGIA TOTAL
	ET=EI+Q
C	DEFINICAO DE ALGUMAS CONSTANTES
	A=(M1*M4*(EI/ET))/((M1+M2)*(M3+M4))
	B=(M1*M3*(EI/ET))/((M1+M2)*(M3+M4))
	C=((M2*M3)/((M1+M2)*(M3+M4)))*(1+((M1*Q)/(M2*ET)))
	D=((M2*M4)/((M1+M2)*(M3+M4)))*(1+((M1*Q)/(M2*ET)))
        write(*,*)a,b,c,d
	WRITE(1,65)
	WRITE(*,65)
 65	FORMAT(1H ,'                C I N E M A T I C A        '//)
C	TRANSFORMANDO GRAUS EM RADIANAS
	WRITE(1,66)M1,M3,EI
	WRITE(*,66)M1,M3,EI
 66	FORMAT(1H ,'M1='F10.4,'   M3='F10.4,'   EI='F10.4)
	WRITE(1,67)M2,M4,Q
	WRITE(*,67)M2,M4,Q
 67	FORMAT(1H ,'M2='F10.4,'   M4='F10.4,'   Q='F15.4,//)
	E=0.0174532925
	WRITE(1,20)
	WRITE(*,20)
	WRITE(*,21)
	WRITE(1,21)
	ANG=(AF-AI)/DELTA
	PANG=IDINT(ANG)+1
	DO 500 LAB=1,PANG
	IF(LAB.EQ.1)GOTO 1000
	AI=AI+DELTA
1000	ALAB=AI*E
	IF(ACM3P.GE.180.)GOTO 50
	ARG=D/B-DSIN(ALAB)**2
	IF(ARG.LT.0.) GO TO 50
	RP=(DCOS(ALAB)+DSQRT(ARG))
	IF(B-D)100,100,200
 200	XMAX=DASIN(DSQRT(D/B))
	IF(ALAB-XMAX)300,300,50
 300	RS=(DCOS(ALAB)-DSQRT((D/B)-(DSIN(ALAB)*DSIN(ALAB))))
C	CALCULO DA ENERGIA DA PARTICULA TRES
	E3P=(RP*RP)*B*ET
	E3S=(RS*RS)*B*ET
C	CALCULO DO ANGULO DE C.M DA PARTICULA TRES
	CASCM=(E3P/ET-B-D)/(2*(DSQRT(A*C)))
	CASCMS=(E3S/ET-B-D)/(2*DSQRT(A*C))
	IF(CASCM.GE.1..OR.CASCMS.GE.1..OR.CASCMS.LE.-1.) THEN
	ACM3P=0.
	ACM3S=180.*E
	GOTO 28
	ENDIF
	ACM3P=DACOS(CASCM)
	ACM3S=DACOS(CASCMS)
C	CALCULO DO JACOBIANODA PARTICULA TRES
 28	YJ=((DSQRT(A*C))*(DSQRT((D/B)-(DSIN(ALAB)*DSIN(ALAB)))))
	YJ3P=YJ/(E3P/ET)
	YJ3S=YJ/(E3S/ET)
C	CALCULO DA ENERGIA DO RECUO
	E4P=ET-E3P
	E4S=ET-E3S
C	CALCULO DO ANGULO DE LAB. DE RECUO
	IF(E4P.EQ.0.) THEN
	RLAB4P=90.*E
	YJ4P=999.999
	GOTO 27
	ENDIF
	RLAB4P=DASIN(DSQRT((M3*E3P)/(M4*E4P))*DSIN(ALAB))
C	CALCULO DO JACOBIANO DA PARTICULA QUATRO
	YJ4P=((DSQRT(A*C))*(DSQRT((C/A)-(DSIN(RLAB4P)*DSIN(RLAB4P)))))/
     *(E4P/ET)
 27	RLAB4S=DASIN(DSQRT((M3*E3S)/(M4*E4S))*DSIN(ALAB))
	YJ4S=((DSQRT(A*C))*(DSQRT((C/A)-(DSIN(RLAB4S)*DSIN(RLAB4S)))))/
     *(E4S/ET)
	F=57.29577951
	ALAB=ALAB*F
	ACM3P=ACM3P*F
	ACM3S=ACM3S*F
	RLAB4P=RLAB4P*F
	RLAB4S=RLAB4S*F
 20	FORMAT(1H ,'   LAB     ENERGIA    ANGULO  JACOBIANO  ENERGIA   ANG
     *     JACOBIANO')
 21	FORMAT(1H ,'  ANGULO    PART.3     C.M        3       RECUO   LAB.
     *REC     4    '//)
	WRITE(1,22)ALAB,E3P,ACM3P,YJ3P,E4P,RLAB4P,YJ4P
	WRITE(*,22)ALAB,E3P,ACM3P,YJ3P,E4P,RLAB4P,YJ4P
 22	FORMAT(1H ,F7.3,F10.4,F10.3,F10.4,F10.4,F10.3,F10.4)
	WRITE(1,23)E3S,ACM3S,YJ3S,E4S,RLAB4S,YJ4S
	WRITE(*,23)E3S,ACM3S,YJ3S,E4S,RLAB4S,YJ4S
 23	FORMAT(1H ,F17.4,F10.3,F10.4,F10.4,F10.3,F9.3)
	GOTO 500
 100	E3P=(RP*RP)*B*ET
	KCM3P=(E3P/ET-B-D)/(2*DSQRT(A*C))
	IF (KCM3P.GE.1.) THEN
	ACM3P=0.
	GOTO 29
	ENDIF
	ACM3P=DACOS(KCM3P)
 29	YJ=((DSQRT(A*C))*DSQRT((D/B)-(DSIN(ALAB)*DSIN(ALAB))))
	YJ3P=YJ/(E3P/ET)
	E4P=ET-E3P
	IF(E4P.EQ.0.) THEN
	RLAB4P=90.*E
	YJ4P=999.999
	GOTO 26
	ENDIF
	RLAB4P=DASIN(DSQRT((M3*E3P)/(M4*E4P))*DSIN(ALAB))
 	YJ4P=((DSQRT(A*C))*(DSQRT((C/A)-(DSIN(RLAB4P)*DSIN(RLAB4P)))))
     */(E4P/ET)
 26	F=57.29577951
	ALAB=ALAB*F
	ACM3P=ACM3P*F
	RLAB4P=RLAB4P*F
 	WRITE(1,24)ALAB,E3P,ACM3P,YJ3P,E4P,RLAB4P,YJ4P
	WRITE(*,24)ALAB,E3P,ACM3P,YJ3P,E4P,RLAB4P,YJ4P
 24	FORMAT(1H ,F7.3,F10.4,F10.3,F10.4,F10.4,F10.3,F10.4)
 500	CONTINUE
	GOTO 700
 50	WRITE(1,25)
	WRITE(*,25)
 25	FORMAT(1H ,'ACIMA DO LIMITE CINEMATICO')
 700	STOP
	END
